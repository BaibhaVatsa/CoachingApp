name: Develop to Staging Merge CI

on:
  pull_request:
    types:
      - closed
    branches:
      - develop

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - name: Assign Author
      uses: technote-space/assign-author@v1.2.4

    - name: Setup Node.js for use with actions
      uses: actions/setup-node@v1.1.0

    - name: Checkout Source Code
      uses: actions/checkout@v2-beta

    - name: Merge Changes to Staging
      run: |
        git checkout staging
        git merge develop
        git push

    - name: Create Pull Request on Staging
      uses: peter-evans/create-pull-request@v1
      with:
        token: ${{ secrets.GITHUB_KEY }}
        commit-message: Merge of Approved Feature Changes from Develop
        title: Develop to Staging Merge
        body: This is an auto-generated PR with Merge of Approved Feature Changes from Develop.
        branch: staging
        branch-suffix: none
